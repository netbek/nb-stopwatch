/*
 * nb-stopwatch
 * 
 * @author Hein Bekker <hein@netbek.co.za>
 * @copyright (c) 2015 Hein Bekker
 * @license http://www.gnu.org/licenses/agpl-3.0.txt AGPLv3
 */
!function(a,b){"use strict";function c(){var a={duration:1e3};return{set:function(b){_.merge(a,b)},$get:function(){return a}}}function d(a,c,d){var e,f,g,h,i=[],j=this,k=!1,l=!1,m=new c;j.start=function(){l||(l=!0,k||(e=a.duration||d.duration,f=Date.now(),g=f+e,k=!0),function b(){h=m.request(function(){var c=Date.now();if(c>g)return void j.stop();var d=(c-f)/e;a.$broadcast("nbStopwatch:render",d),b()})}())},j.stop=function(){l&&(l=!1,h&&(m.cancel(h),h=null))},j.reset=function(){var a=l;l&&j.stop(),e=null,f=null,g=null,k=!1,a&&j.start()},i.push(a.$on("nbStopwatch:start",function(){j.start()})),i.push(a.$on("nbStopwatch:stop",function(){j.stop()})),i.push(a.$on("nbStopwatch:reset",function(){j.reset()})),i.push(a.$on("nbStopwatch:restart",function(){j.reset(),j.start()})),a.$on("$destroy",function(){j.stop(),b.forEach(i,function(a){a()})})}function e(){return{restrict:"EA",transclude:!0,replace:!0,controller:"nbStopwatchController",templateUrl:"templates/nb-stopwatch.html",scope:{duration:"=?"}}}function f(){return{require:"^nbStopwatch",restrict:"EA",link:function(a,c){var d=[];d.push(a.$on("nbStopwatch:render",function(a,b){var d="rotate("+360*b+"deg)";c.css({"-webkit-transform":d,"-moz-transform":d,"-o-transform":d,transform:d})})),a.$on("$destroy",function(){b.forEach(d,function(a){a()})})}}}b.module("nb.stopwatch",["nb.stopwatch.templates","nb.animationFrame","nb.lodash"]).provider("nbStopwatchConfig",c).controller("nbStopwatchController",d).directive("nbStopwatch",e).directive("nbStopwatchHand",f),Date.now||(Date.now=function(){return(new Date).getTime()}),d.$inject=["$scope","AnimationFrame","nbStopwatchConfig"]}(window,window.angular),angular.module("nb.stopwatch.templates",["templates/nb-stopwatch.html"]),angular.module("templates/nb-stopwatch.html",[]).run(["$templateCache",function(a){a.put("templates/nb-stopwatch.html",'<div class="stopwatch">\n	<div class="stopwatch-clock">\n		<div class="stopwatch-face"></div>\n		<div nb-stopwatch-hand class="stopwatch-hand"></div>\n	</div>\n</div>')}]);